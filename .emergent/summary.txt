<analysis>**original_problem_statement:**
The user wants to build a WRC (World Rally Championship) style dashboard overlay. The application must be entirely frontend, using local storage for data persistence.

**PRODUCT REQUIREMENTS:**
1.  **Two Main Pages:**  (for configuration) and  (for live display).
2.  **Stage-Type Architecture:** The system must support different types of stages (SS, Lap Race, Liaison, etc.), with the UI and logic adapting dynamically.
3.  **Setup Page Features:**
    *   Manage Event Name, Stages, Pilots (including Car Number), and Categories.
    *   A dynamic Times tab that shows different time-entry UIs based on stage type.
    *   A Config tab for JSON import/export, chroma key, Google Maps URL, and a channel logo URL.
    *   A Streams tab to manage pilot stream settings.
4.  **Overlay Page Features:**
    *   Display a branding logo on all scenes.
    *   Animate pilot position changes.
    *   Scene 1 (Live Stage): Show current stage activity.
    *   Scene 2 (Timing Tower): Show live rankings for the current stage.
    *   Scene 3 (Leaderboard): Show overall and per-stage results.
    *   Scene 4 (Pilot Focus): Focus on a single pilot's stream and data.
5.  **Internationalization (i18n):** The entire application must be translatable. The user should be able to easily add new languages by editing simple text files (YAML). The Setup and Overlay pages should have independent language selectors.
6.  **Additional Cameras:**
    *   The user must be able to add and manage generic camera streams (e.g., drone shots, external cameras) in the Streams tab.
    *   These cameras should be selectable items in the overlay scenes, often with higher priority than pilot cameras.
    *   Scene 1: Cameras appear in the selection list before Google Maps and pilots.
    *   Scene 2: A camera can be shown in the main display area.
    *   Scene 4: A camera can be the main feed, with the focused pilot's stream appearing as a Picture-in-Picture (PiP) overlay.

**User's preferred language**: English

**what currently exists?**
The project is a complex, frontend-only React application. The stage-type driven architecture is fully implemented and tested. A complete internationalization (i18n) system has been built using  and React Context, and the entire UI has been updated to use translation keys. Independent language selectors exist on both the Setup and Overlay pages.

The agent has just begun implementing the Additional Cameras feature. The data model () has been updated to include a  array with corresponding CRUD functions, the translation files have been updated with new keys, and the  UI has been modified to allow managing these new cameras. Work has started on  to integrate cameras into the display logic.

**Last working item**:
-   **Last item agent was working:** The agent was implementing the Additional Cameras feature. It was in the middle of updating  to integrate the new cameras into the item selection list and the main display grid.
-   **Status:** IN PROGRESS
-   **Agent Testing Done:** N
-   **Which testing method agent to use?** frontend testing agent
-   **User Testing Done:** N

**All Pending/In progress Issue list**:
-   **Issue 1: Shared Language State (P2)**
    -   **Description:** The independent language selectors on the Setup and Overlay pages both write to the same  key (). This causes them to sync, which may be unintended. When a user changes the language on the Setup page, it also changes on the Overlay page, and vice-versa.
    -   **Next debug checklist:**
        1.  In , modify the  hook that saves the language to .
        2.  Introduce a parameter or a separate context provider instance to differentiate between the 'setup' and 'overlay' contexts.
        3.  Use two different  keys, e.g.,  and .
    -   **Why fix this issue and what will be achieved with the fix?** To provide true independence for the language selection on the two main pages, as requested by the user.
    -   **Status:** NOT STARTED
    -   **Is recurring issue?** N
    -   **Should Test frontend/backend/both after fix?** Frontend

**In progress Task List**:
-   **Task 1 (P0): Complete Additional Cameras Feature Implementation**
    -   **Where to resume:**
        1.  Complete the modifications in . The data source has been updated, but the rendering, selection, and drag-and-drop logic for cameras needs to be finalized and verified.
        2.  Update  to allow selecting a camera feed to be displayed in the main view area.
        3.  Update  to allow selecting a camera as the main feed, which should trigger the focused pilot's stream to be displayed in a Picture-in-Picture (PiP) overlay.
        4.  Perform thorough testing of the new camera functionality across all relevant scenes.
    -   **What will be achieved with this?** The user will be able to add external camera feeds and display them in various ways on the live overlay, significantly enhancing production capabilities.
    -   **Status:** IN PROGRESS
    -   **Should Test frontend/backend/both after fix?** Frontend

**Upcoming and Future Tasks**
-   **Upcoming Tasks:**
    -   **P1: Implement Countdown Timer:** In timing displays, show a countdown in seconds when < 1 minute to start, and with decimals when < 10 seconds.
    -   **P2: Lap Race Start Time Logic:** Add a separate actual start time field for Lap Races to accurately calculate elapsed time.
-   **Future Tasks:**
    -   **P3: Implement RallyX Point System.**
    -   **P4: Optimize Stream Loading:** Keep video stream elements loaded in the background to prevent re-initialization lag when switching scenes.
    -   **P5: Add Keyboard Shortcuts:** For global audio controls.

**Completed work in this session**
-   **Stage-Type Architecture Completion:**
    -   Updated  and  to support Lap Race and SS types.
    -   Fixed  bug where the clock button didn't trigger total time recalculation.
    -   Fixed a React Hook rule violation in .
    -   Passed comprehensive tests via the testing agent for the refactor.
-   **Full Internationalization (i18n) System:**
    -   Integrated  and created a  to manage languages.
    -   Created  and  translation files.
    -   Replaced hardcoded strings with  calls across the entire application (Setup and Overlay pages).
    -   Added a  component to the Setup page's Config tab.
    -   Added an independent, compact language selector to the Overlay page's top bar.
-   **Deployment Fix:**
    -   Fixed an issue where translation files failed to load on GitHub Pages by correctly using  in the fetch path.

**Earlier issues found/mentioned but not fixed**
None.

**Known issue recurrence from previous fork**
None.

**Code Architecture**


**Key Technical Concepts**
-   **Frontend:** React, Tailwind CSS, Shadcn/UI
-   **State Management:** React Context API (, ) persisting to .
-   **Internationalization (i18n):** Runtime language switching by fetching and parsing YAML files ().
-   **Architecture:** Stage-type driven logic; Component-based UI.
-   **Data Sync:** WebSocket (Ably) and  polling fallback.

**key DB schema**
The application uses . The key data structures now include:
-   : 
-   :  (e.g., 'en', 'pt-BR') - **Note: This key is currently shared by two independent UIs.**
-   (Other keys like , , 0m0.000s 0m0.000s
0m0.000s 0m0.000s, , , etc. remain as before).

**changes in tech stack**
-   Added  dependency for parsing translation files.

**All files of reference**
-   **Currently being modified:**
    -   
    -   
    -   
-   **Next to be modified:**
    -   
    -   
-   **New core files:**
    -   
    -   
    -   

**Areas that need refactoring**:
-   The language persistence logic in  should be reviewed to address the Shared Language State issue mentioned in the pending issues list. Using separate  keys for the Setup and Overlay pages would be a clean solution.

**key api endpoints**
Not applicable. The application is 100% frontend.

**Critical Info for New Agent**
-   You are resuming work in the middle of the **Additional Cameras** feature implementation. The data model and setup UI are done. Your first task is to complete the integration of cameras into , then proceed to implement camera functionality in  and  as per the user's requirements.
-   The internationalization (i18n) system is complete. Any new UI text you add **must** use the  function from the  hook. Remember to add new translation keys to both  and .
-   Be aware of the pending issue regarding the shared  key for language selection. While not a blocker for the current task, it's a known issue that should be addressed soon.

**documents and test reports created in this job**
-   
-    (updated)

**Last 10 User Messages and any pending HUMAN messages**
1.  **User:** Requests translation for the entire application. (COMPLETED)
2.  **Agent:** Acknowledges and begins translating the Setup page. (COMPLETED)
3.  **Agent:** Continues translating Setup page tabs. (COMPLETED)
4.  **Agent:** Begins translating the Overlay page components. (COMPLETED)
5.  **User:** you can continue. (COMPLETED)
6.  **Agent:** Continues translating Scene 3 and Scene 4. (COMPLETED)
7.  **Agent:** Continues translating Scene 1 and Scene 2. (COMPLETED)
8.  **Agent:** Summarizes the completion of the full translation system. (COMPLETED)
9.  **User:** Reports two new issues: 1) Overlay page needs its own language selector, and 2) Translations are broken on GitHub pages deployment. (COMPLETED)
10. **User:** Requests a major new feature: Additional Cameras, providing detailed requirements for their management and display in Scenes 1, 2, and 4. (IN PROGRESS)

**Project Health Check:**
-   **Broken:** The Additional Cameras feature is incomplete. The application will run, but the functionality is not fully implemented in the overlay scenes.
-   **Mocked:** Audio meters are still using simulated data.

**3rd Party Integrations**
-   **Ably:** For WebSocket-based live data synchronization.
-   **js-yaml:** Used to parse YAML translation files at runtime.

**Testing status**
-   **Testing agent used after significant changes:** YES, after the major stage-type architecture refactor.
-   **Troubleshoot agent used after agent stuck in loop:** NO
-   **Test files created:** None
-   **Known regressions:** None from previous work, but the new Cameras feature is not yet functional on the overlay.

**Credentials to test flow:**
An Ably API key is pre-configured in . No other credentials are required.

**What agent forgot to execute**
The agent is in the middle of a large feature request and has not forgotten any steps, but the implementation is not yet complete. The agent correctly identified a potential issue with the shared  key for language selection but has not yet addressed it, as it is a lower priority than the active feature request.</analysis>
